# 基于离线强化学习的败血症诊断辅助系统 🏥

[![Python](https://img.shields.io/badge/Python-3.7+-blue?logo=python)](https://www.python.org/)
[![PyTorch](https://img.shields.io/badge/PyTorch-✔-red?logo=pytorch)](https://pytorch.org/)
[![医疗AI](https://img.shields.io/badge/Healthcare_AI-Applied-8A2BE2)](https://www.mimic-iv.mit.edu/)

本课题基于MIMIC-III重症监护数据库，探索DNN/DKRR/KGA三种算法在败血症诊断中的离线强化学习应用，为临床决策提供智能支持。

## 数据介绍 📊

### 数据集特性
| 属性               | 描述                          |
|--------------------|-------------------------------|
| 来源               | MIMIC-III 重症监护数据库      |
| 患者数量           | 18,557名患者轨迹数据          |
| 数据划分           | 训练集(70%)/验证集(15%)/测试集(15%) |
| 轨迹长度分布       | ≤15步：12,510条；≤10步：5,600条 |

### 特征空间
- **人口统计特征** (5维)
  - 性别、机械通气、再入院、年龄、体重
- **医学指标** (33维)
  - GCS评分、心率、血压、呼吸频率、体温等

### 动作空间
- 25种离散治疗方案组合（液体与血管加压药物剂量）

---

## 研究问题 🎯
**核心挑战**：如何从复杂医疗数据中学习最优治疗策略？
- 奖励函数设计：`R = +1（48小时存活）/-1（死亡）`
- 算法需处理：
  - 长短期依赖（轨迹长度1-15步）
  - 高维状态空间（38维特征）
  - 稀疏奖励信号（仅最终状态标记）

---

## 算法架构 🧠

### 核心算法对比
| 算法 | 优势 | 局限性 |
|------|------|--------|
| **DNN** | 强非线性拟合能力<br>自动特征提取 | 计算资源需求高<br>可解释性弱 |
| **DKRR** | 正则化防止过拟合<br>分布式计算优化 | 核函数选择敏感<br>内存消耗大 |
| **KGA** | 快速收敛<br>样本选择高效 | 局部最优风险<br>参数调整复杂 |

### 训练流程
```python
for 每个时间步 in 轨迹数据:
    构建状态-动作对 (s_t, a_t)
    计算Q值更新:
        Q(s,a) ← Q(s,a) + α[r + γ max Q(s',a') - Q(s,a)]
    分算法实现：
        DNN: 反向传播更新权重
        DKRR: 分布式核矩阵计算
        KGA: 贪婪样本选择策略
